{"version":3,"names":["PdfDownloadButton","applicationId","variant","cov_1axmwqc0zt","b","size","f","isLoading","setIsLoading","s","_react","useState","apiUrl","process","env","NEXT_PUBLIC_API_URL","handleDownload","type","endpoint","response","fetch","ok","Error","blob","url","window","URL","createObjectURL","a","document","createElement","href","download","body","appendChild","click","revokeObjectURL","removeChild","_sonner","toast","success","error","console","handlePreview","open","_jsxruntime","jsxs","_dropdownmenu","DropdownMenu","jsx","DropdownMenuTrigger","asChild","_button","Button","disabled","Fragment","_lucidereact","Loader2","className","Download","DropdownMenuContent","align","DropdownMenuLabel","DropdownMenuSeparator","DropdownMenuItem","onClick","FileText","Eye"],"sources":["/Users/noritakasawada/AI_P/subsidyApp/frontend/src/components/pdf/PdfDownloadButton.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { Button } from '@/components/ui/button';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu';\nimport { Download, FileText, Eye, Loader2 } from 'lucide-react';\nimport { toast } from 'sonner';\n\ninterface PdfDownloadButtonProps {\n  applicationId: string;\n  variant?: 'default' | 'outline' | 'ghost';\n  size?: 'default' | 'sm' | 'lg';\n}\n\nexport function PdfDownloadButton({\n  applicationId,\n  variant = 'default',\n  size = 'default',\n}: PdfDownloadButtonProps) {\n  const [isLoading, setIsLoading] = useState(false);\n  const apiUrl = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001';\n\n  const handleDownload = async (type: 'full' | 'summary') => {\n    setIsLoading(true);\n    \n    try {\n      const endpoint = type === 'full' \n        ? `${apiUrl}/api/pdf-generator/application/${applicationId}`\n        : `${apiUrl}/api/pdf-generator/application/${applicationId}/summary`;\n      \n      const response = await fetch(endpoint);\n      \n      if (!response.ok) {\n        throw new Error('PDF生成に失敗しました');\n      }\n      \n      const blob = await response.blob();\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = type === 'full' \n        ? `application_${applicationId}.pdf`\n        : `summary_${applicationId}.pdf`;\n      document.body.appendChild(a);\n      a.click();\n      window.URL.revokeObjectURL(url);\n      document.body.removeChild(a);\n      \n      toast.success('PDFのダウンロードが完了しました');\n    } catch (error) {\n      console.error('PDF download error:', error);\n      toast.error('PDFのダウンロードに失敗しました');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handlePreview = async () => {\n    setIsLoading(true);\n    \n    try {\n      const endpoint = `${apiUrl}/api/pdf-generator/application/${applicationId}/preview`;\n      window.open(endpoint, '_blank');\n      toast.success('PDFプレビューを開きました');\n    } catch (error) {\n      console.error('PDF preview error:', error);\n      toast.error('PDFプレビューに失敗しました');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <Button variant={variant} size={size} disabled={isLoading}>\n          {isLoading ? (\n            <>\n              <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n              生成中...\n            </>\n          ) : (\n            <>\n              <Download className=\"mr-2 h-4 w-4\" />\n              PDF出力\n            </>\n          )}\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent align=\"end\">\n        <DropdownMenuLabel>PDF出力オプション</DropdownMenuLabel>\n        <DropdownMenuSeparator />\n        <DropdownMenuItem onClick={() => handleDownload('full')}>\n          <FileText className=\"mr-2 h-4 w-4\" />\n          完全版申請書\n        </DropdownMenuItem>\n        <DropdownMenuItem onClick={() => handleDownload('summary')}>\n          <FileText className=\"mr-2 h-4 w-4\" />\n          サマリーレポート\n        </DropdownMenuItem>\n        <DropdownMenuSeparator />\n        <DropdownMenuItem onClick={handlePreview}>\n          <Eye className=\"mr-2 h-4 w-4\" />\n          プレビュー\n        </DropdownMenuItem>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;+BAqBgB;;;;;;WAAAA,iBAAA;;;;;;;;kCAnBS;;;kCACF;;;kCAQhB;;;kCAC0C;;;kCAC3B;AAQf,SAASA,kBAAkB;EAChCC,aAAa;EACbC,OAAA;EAAA;EAAA,CAAAC,cAAA,GAAAC,CAAA,UAAU,SAAS;EACnBC,IAAA;EAAA;EAAA,CAAAF,cAAA,GAAAC,CAAA,UAAO,SAAS;AAAA,CACO;EAAA;EAAAD,cAAA,GAAAG,CAAA;EACvB,MAAM,CAACC,SAAA,EAAWC,YAAA,CAAa;EAAA;EAAA,CAAAL,cAAA,GAAAM,CAAA,OAAG,IAAAC,MAAA,CAAAC,QAAQ,EAAC;EAC3C,MAAMC,MAAA;EAAA;EAAA,CAAAT,cAAA,GAAAM,CAAA;EAAS;EAAA,CAAAN,cAAA,GAAAC,CAAA,UAAAS,OAAA,CAAQC,GAAG,CAACC,mBAAmB;EAAA;EAAA,CAAAZ,cAAA,GAAAC,CAAA,UAAI;EAAA;EAAAD,cAAA,GAAAM,CAAA;EAElD,MAAMO,cAAA,GAAiB,MAAOC,IAAA;IAAA;IAAAd,cAAA,GAAAG,CAAA;IAAAH,cAAA,GAAAM,CAAA;IAC5BD,YAAA,CAAa;IAAA;IAAAL,cAAA,GAAAM,CAAA;IAEb,IAAI;MACF,MAAMS,QAAA;MAAA;MAAA,CAAAf,cAAA,GAAAM,CAAA,QAAWQ,IAAA,KAAS;MAAA;MAAA,CAAAd,cAAA,GAAAC,CAAA,UACtB,GAAGQ,MAAA,kCAAwCX,aAAA,EAAe;MAAA;MAAA,CAAAE,cAAA,GAAAC,CAAA,UAC1D,GAAGQ,MAAA,kCAAwCX,aAAA,UAAuB;MAEtE,MAAMkB,QAAA;MAAA;MAAA,CAAAhB,cAAA,GAAAM,CAAA,QAAW,MAAMW,KAAA,CAAMF,QAAA;MAAA;MAAAf,cAAA,GAAAM,CAAA;MAE7B,IAAI,CAACU,QAAA,CAASE,EAAE,EAAE;QAAA;QAAAlB,cAAA,GAAAC,CAAA;QAAAD,cAAA,GAAAM,CAAA;QAChB,MAAM,IAAIa,KAAA,CAAM;MAClB;MAAA;MAAA;QAAAnB,cAAA,GAAAC,CAAA;MAAA;MAEA,MAAMmB,IAAA;MAAA;MAAA,CAAApB,cAAA,GAAAM,CAAA,QAAO,MAAMU,QAAA,CAASI,IAAI;MAChC,MAAMC,GAAA;MAAA;MAAA,CAAArB,cAAA,GAAAM,CAAA,QAAMgB,MAAA,CAAOC,GAAG,CAACC,eAAe,CAACJ,IAAA;MACvC,MAAMK,CAAA;MAAA;MAAA,CAAAzB,cAAA,GAAAM,CAAA,QAAIoB,QAAA,CAASC,aAAa,CAAC;MAAA;MAAA3B,cAAA,GAAAM,CAAA;MACjCmB,CAAA,CAAEG,IAAI,GAAGP,GAAA;MAAA;MAAArB,cAAA,GAAAM,CAAA;MACTmB,CAAA,CAAEI,QAAQ,GAAGf,IAAA,KAAS;MAAA;MAAA,CAAAd,cAAA,GAAAC,CAAA,UAClB,eAAeH,aAAA,MAAmB;MAAA;MAAA,CAAAE,cAAA,GAAAC,CAAA,UAClC,WAAWH,aAAA,MAAmB;MAAA;MAAAE,cAAA,GAAAM,CAAA;MAClCoB,QAAA,CAASI,IAAI,CAACC,WAAW,CAACN,CAAA;MAAA;MAAAzB,cAAA,GAAAM,CAAA;MAC1BmB,CAAA,CAAEO,KAAK;MAAA;MAAAhC,cAAA,GAAAM,CAAA;MACPgB,MAAA,CAAOC,GAAG,CAACU,eAAe,CAACZ,GAAA;MAAA;MAAArB,cAAA,GAAAM,CAAA;MAC3BoB,QAAA,CAASI,IAAI,CAACI,WAAW,CAACT,CAAA;MAAA;MAAAzB,cAAA,GAAAM,CAAA;MAE1B6B,OAAA,CAAAC,KAAK,CAACC,OAAO,CAAC;IAChB,EAAE,OAAOC,KAAA,EAAO;MAAA;MAAAtC,cAAA,GAAAM,CAAA;MACdiC,OAAA,CAAQD,KAAK,CAAC,uBAAuBA,KAAA;MAAA;MAAAtC,cAAA,GAAAM,CAAA;MACrC6B,OAAA,CAAAC,KAAK,CAACE,KAAK,CAAC;IACd,UAAU;MAAA;MAAAtC,cAAA,GAAAM,CAAA;MACRD,YAAA,CAAa;IACf;EACF;EAAA;EAAAL,cAAA,GAAAM,CAAA;EAEA,MAAMkC,aAAA,GAAgB,MAAAA,CAAA;IAAA;IAAAxC,cAAA,GAAAG,CAAA;IAAAH,cAAA,GAAAM,CAAA;IACpBD,YAAA,CAAa;IAAA;IAAAL,cAAA,GAAAM,CAAA;IAEb,IAAI;MACF,MAAMS,QAAA;MAAA;MAAA,CAAAf,cAAA,GAAAM,CAAA,QAAW,GAAGG,MAAA,kCAAwCX,aAAA,UAAuB;MAAA;MAAAE,cAAA,GAAAM,CAAA;MACnFgB,MAAA,CAAOmB,IAAI,CAAC1B,QAAA,EAAU;MAAA;MAAAf,cAAA,GAAAM,CAAA;MACtB6B,OAAA,CAAAC,KAAK,CAACC,OAAO,CAAC;IAChB,EAAE,OAAOC,KAAA,EAAO;MAAA;MAAAtC,cAAA,GAAAM,CAAA;MACdiC,OAAA,CAAQD,KAAK,CAAC,sBAAsBA,KAAA;MAAA;MAAAtC,cAAA,GAAAM,CAAA;MACpC6B,OAAA,CAAAC,KAAK,CAACE,KAAK,CAAC;IACd,UAAU;MAAA;MAAAtC,cAAA,GAAAM,CAAA;MACRD,YAAA,CAAa;IACf;EACF;EAAA;EAAAL,cAAA,GAAAM,CAAA;EAEA,oBACE,IAAAoC,WAAA,CAAAC,IAAA,EAACC,aAAA,CAAAC,YAAY;4BACX,IAAAH,WAAA,CAAAI,GAAA,EAACF,aAAA,CAAAG,mBAAmB;MAACC,OAAO;gBAC1B,iBAAAN,WAAA,CAAAI,GAAA,EAACG,OAAA,CAAAC,MAAM;QAACnD,OAAA,EAASA,OAAA;QAASG,IAAA,EAAMA,IAAA;QAAMiD,QAAA,EAAU/C,SAAA;kBAC7CA,SAAA;QAAA;QAAA,cAAAJ,cAAA,GAAAC,CAAA,UACC,IAAAyC,WAAA,CAAAC,IAAA,EAAAD,WAAA,CAAAU,QAAA;kCACE,IAAAV,WAAA,CAAAI,GAAA,EAACO,YAAA,CAAAC,OAAO;YAACC,SAAA,EAAU;cAA8B;;;kDAInD,IAAAb,WAAA,CAAAC,IAAA,EAAAD,WAAA,CAAAU,QAAA;kCACE,IAAAV,WAAA,CAAAI,GAAA,EAACO,YAAA,CAAAG,QAAQ;YAACD,SAAA,EAAU;cAAiB;;;qBAM7C,IAAAb,WAAA,CAAAC,IAAA,EAACC,aAAA,CAAAa,mBAAmB;MAACC,KAAA,EAAM;8BACzB,IAAAhB,WAAA,CAAAI,GAAA,EAACF,aAAA,CAAAe,iBAAiB;kBAAC;uBACnB,IAAAjB,WAAA,CAAAI,GAAA,EAACF,aAAA,CAAAgB,qBAAqB,O,aACtB,IAAAlB,WAAA,CAAAC,IAAA,EAACC,aAAA,CAAAiB,gBAAgB;QAACC,OAAA,EAASA,CAAA,KAAM;UAAA;UAAA9D,cAAA,GAAAG,CAAA;UAAAH,cAAA,GAAAM,CAAA;UAAA,OAAAO,cAAA,CAAe;QAAA;gCAC9C,IAAA6B,WAAA,CAAAI,GAAA,EAACO,YAAA,CAAAU,QAAQ;UAACR,SAAA,EAAU;YAAiB;uBAGvC,IAAAb,WAAA,CAAAC,IAAA,EAACC,aAAA,CAAAiB,gBAAgB;QAACC,OAAA,EAASA,CAAA,KAAM;UAAA;UAAA9D,cAAA,GAAAG,CAAA;UAAAH,cAAA,GAAAM,CAAA;UAAA,OAAAO,cAAA,CAAe;QAAA;gCAC9C,IAAA6B,WAAA,CAAAI,GAAA,EAACO,YAAA,CAAAU,QAAQ;UAACR,SAAA,EAAU;YAAiB;uBAGvC,IAAAb,WAAA,CAAAI,GAAA,EAACF,aAAA,CAAAgB,qBAAqB,O,aACtB,IAAAlB,WAAA,CAAAC,IAAA,EAACC,aAAA,CAAAiB,gBAAgB;QAACC,OAAA,EAAStB,aAAA;gCACzB,IAAAE,WAAA,CAAAI,GAAA,EAACO,YAAA,CAAAW,GAAG;UAACT,SAAA,EAAU;YAAiB;;;;AAM1C","ignoreList":[]}