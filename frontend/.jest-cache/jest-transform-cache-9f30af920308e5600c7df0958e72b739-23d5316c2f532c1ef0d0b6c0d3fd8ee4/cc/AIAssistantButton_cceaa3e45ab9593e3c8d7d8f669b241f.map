{"version":3,"names":["AIAssistantButton","feature","data","onApply","buttonText","cov_5t095sy15","b","dialogTitle","dialogDescription","f","isOpen","setIsOpen","s","_react","useState","result","setResult","ai","_useAIAssistant","useAIAssistant","onSuccess","response","handleAnalyze","analyzeIssues","businessDescription","painPoints","businessType","suggestSolutions","currentIssues","maxAmount","implementationPeriod","suggestKPIs","businessPlan","expectedEffects","analyzeRisks","implementationDetails","analyzeMarket","targetCustomer","region","handleApply","content","renderContent","type","_jsxruntime","jsx","className","_reactmarkdown","default","JSON","stringify","jsxs","_dialog","Dialog","open","onOpenChange","DialogTrigger","asChild","_button","Button","variant","size","_lucidereact","Sparkles","DialogContent","DialogHeader","DialogTitle","DialogDescription","isLoading","onClick","disabled","Fragment","Loader2","_card","Card","CardHeader","CardTitle","_badge","Badge","tokensUsed","confidence","toFixed","CardContent","error","message"],"sources":["/Users/noritakasawada/AI_P/subsidyApp/frontend/src/components/ai/AIAssistantButton.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { Button } from '@/components/ui/button';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from '@/components/ui/dialog';\nimport { Sparkles, Loader2 } from 'lucide-react';\nimport { useAIAssistant } from '@/hooks/useAIAssistant';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport ReactMarkdown from 'react-markdown';\n\ninterface AIAssistantButtonProps {\n  feature: 'issues' | 'solutions' | 'kpis' | 'risks' | 'market';\n  data: any;\n  onApply?: (result: any) => void;\n  buttonText?: string;\n  dialogTitle?: string;\n  dialogDescription?: string;\n}\n\nexport function AIAssistantButton({\n  feature,\n  data,\n  onApply,\n  buttonText = 'AI提案',\n  dialogTitle = 'AI アシスタント',\n  dialogDescription = 'AIが分析・提案を行います',\n}: AIAssistantButtonProps) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [result, setResult] = useState<any>(null);\n  const ai = useAIAssistant({\n    onSuccess: (response) => {\n      setResult(response);\n    },\n  });\n\n  const handleAnalyze = async () => {\n    switch (feature) {\n      case 'issues':\n        await ai.analyzeIssues(\n          data.businessDescription,\n          data.painPoints,\n          data.businessType\n        );\n        break;\n      case 'solutions':\n        await ai.suggestSolutions(\n          data.currentIssues,\n          data.businessType,\n          data.maxAmount,\n          data.implementationPeriod\n        );\n        break;\n      case 'kpis':\n        await ai.suggestKPIs(\n          data.businessPlan,\n          data.expectedEffects\n        );\n        break;\n      case 'risks':\n        await ai.analyzeRisks(\n          data.businessPlan,\n          data.implementationDetails\n        );\n        break;\n      case 'market':\n        await ai.analyzeMarket(\n          data.businessDescription,\n          data.targetCustomer,\n          data.region\n        );\n        break;\n    }\n  };\n\n  const handleApply = () => {\n    if (result && onApply) {\n      onApply(result.content);\n      setIsOpen(false);\n    }\n  };\n\n  const renderContent = () => {\n    if (!result) return null;\n\n    if (result.type === 'markdown') {\n      return (\n        <div className=\"prose prose-sm max-w-none\">\n          <ReactMarkdown>{result.content}</ReactMarkdown>\n        </div>\n      );\n    }\n\n    if (result.type === 'json') {\n      return (\n        <pre className=\"bg-gray-50 p-4 rounded-lg overflow-auto text-sm\">\n          {JSON.stringify(result.content, null, 2)}\n        </pre>\n      );\n    }\n\n    return <p className=\"whitespace-pre-wrap\">{result.content}</p>;\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={setIsOpen}>\n      <DialogTrigger asChild>\n        <Button variant=\"outline\" size=\"sm\">\n          <Sparkles className=\"h-4 w-4 mr-2\" />\n          {buttonText}\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"max-w-3xl max-h-[80vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>{dialogTitle}</DialogTitle>\n          <DialogDescription>{dialogDescription}</DialogDescription>\n        </DialogHeader>\n        \n        <div className=\"space-y-4 mt-4\">\n          {!result && !ai.isLoading && (\n            <div className=\"text-center py-8\">\n              <Button onClick={handleAnalyze} disabled={ai.isLoading}>\n                {ai.isLoading ? (\n                  <>\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    分析中...\n                  </>\n                ) : (\n                  <>\n                    <Sparkles className=\"mr-2 h-4 w-4\" />\n                    AI分析を開始\n                  </>\n                )}\n              </Button>\n            </div>\n          )}\n\n          {ai.isLoading && (\n            <div className=\"flex items-center justify-center py-8\">\n              <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n              <span className=\"ml-3\">AIが分析しています...</span>\n            </div>\n          )}\n\n          {result && (\n            <Card>\n              <CardHeader>\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle className=\"text-lg\">分析結果</CardTitle>\n                  <div className=\"flex gap-2\">\n                    <Badge variant=\"outline\">\n                      {result.tokensUsed} トークン使用\n                    </Badge>\n                    {result.confidence && (\n                      <Badge variant=\"secondary\">\n                        信頼度: {(result.confidence * 100).toFixed(0)}%\n                      </Badge>\n                    )}\n                  </div>\n                </div>\n              </CardHeader>\n              <CardContent>\n                {renderContent()}\n                \n                {onApply && (\n                  <div className=\"mt-4 flex justify-end gap-2\">\n                    <Button variant=\"outline\" onClick={() => setResult(null)}>\n                      再分析\n                    </Button>\n                    <Button onClick={handleApply}>\n                      この内容を適用\n                    </Button>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          )}\n\n          {ai.error && (\n            <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n              <p className=\"text-red-800\">エラー: {ai.error.message}</p>\n            </div>\n          )}\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}